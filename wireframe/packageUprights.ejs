<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<title>Package Show</title>
	<link rel="stylesheet" type="text/css" href="/css/style.css">
    <!-- <link rel="stylesheet" type="text/css" href="/css/packageUprights.css"> -->
	<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>  
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script> 

	<style>  
		/* .hide {
			display: hidden;
		} */
		
		.upright {
			width: 816px;
			height: 1054px;
			text-align: center;
			background: rgb(32, 108, 194);
			color: #fff;
			padding: 25px 0px;
		}

		.donor {
			background: black;
			width: 100%;
			height: 8%;
			position: relative;
			font-size: 30px;
		}

		.resized-text {
			width: 90%;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}

		.title {
			width: 100%;
			height: 9%;
			font-size: 60px;
			position: relative;
			margin: 2% 0px;
			font-weight: bold;
			letter-spacing: 0.5px;
			/* background: pink; */
		}

		.image {
			width: 100%;
			height: 40%;
			margin-bottom: 5%;
			font-size: 30px;
		}

		.flexible-photo {
			max-width: 90%;
			max-height: 100%;
			border: 5px solid black;
		}

		.packageId {
			background: black;
			position: relative;
			bottom: 93%;
			width: 30%;
			text-align: right;
			padding: .7% 5% .7% 0px;
		}

		.value {
			background: black;
			position: relative;
			bottom: 32%;
			left: 70%;
			width: 30%;
			text-align: left;
			padding-left: 5%;
			padding: .7% 0px .7% 5%;
		}

		#fitin {
			font-size: 40px;
			background: black;
			width: 100%;
			height: 35%;
			position: relative;
			padding: 3% 0px;
		}
	</style> 

	<script>
		$(function() {
			$('#fitin div').css('font-size', '1em');
			
			while( $('#fitin div').height() > $('#fitin').height() ) {
				$('#fitin div').css('font-size', (parseInt($('#fitin div').css('font-size')) - 1) + "px" );
			}

			$('.donor div').css('font-size', '1em');
			
			while( $('.donor div').height() > $('.donor').height() ) {
				$('.donor div').css('font-size', (parseInt($('.donor div').css('font-size')) - 1) + "px" );
			}

			$('.title div').css('font-size', '1em');
			
			while( $('.title div').height() > $('.title').height() ) {
				$('.title div').css('font-size', (parseInt($('.title div').css('font-size')) - 1) + "px" );
			}
			
		});
	</script>
	
  </head>

	<body>

		<input type="button" id="create_pdf" value="Open PDF">
		<div class="hide">
			<form class="form">
				<div class="upright">

					<div class="donor">
						<div class="resized-text">
							Donors: Mr. & Mrs. Jones, Larry Graham, John and Jane Doe, Toys 'R' Us, Michael and Jennifer Ng
						</div>
					</div>

					<div class="title">
						<div class="resized-text">
							<%= package.name %>
						</div>
					</div>

					<div class="image">
						<img class="flexible-photo" src="/<%= package.photo %>">
						
						<div class="packageId">
							#<%= package._id%>
						</div>

						<div class="value">
							Value: $<%= package.value%>
						</div>
					</div>

					<div id="fitin">
						<div class="resized-text">
							<%= package.description %>
						</div>
					</div>
				</div>
			</form>
		</div>
 
		
		<script>  
			(function () {  
				var  
					form = $('.form'),  
					cache_width = form.width(),  
					a4 = [2550, 3300]; // for a4 size paper width and height  
			
				$('#create_pdf').on('click', function () {  
					$('body').scrollTop(0);  
					createPDF();  
				});  

				//create pdf  
				function createPDF() {  
					getCanvas().then(function (canvas) {  
						var  
							img = canvas.toDataURL("image/png"),  
							doc = new jsPDF({  
								unit: 'in',  
								// format: 'letter' 
								format: [8.5, 11]
							});  
						doc.addImage(img, 'JPEG', 0, 0);  
						// doc.addImage(img, 0, 0);
						// doc.save('css-test.pdf'); 
						window.open(URL.createObjectURL(doc.output("blob")));
						form.width(cache_width);  
					});  
				}  
			
				// create canvas object  
				function getCanvas() {  
					form.width((a4[0] * 1.33333) - 80).css('max-width', 'none');  
					return html2canvas(form, {  
						imageTimeout: 2000,  
						removeContainer: true  
					});  
				}  
			
			}());  
		</script>  
	</body>
